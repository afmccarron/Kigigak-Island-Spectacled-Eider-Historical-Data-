CLEAR ALL
SET BELL OFF
SET TALK OFF
SET ESCAPE OFF
SET EXACT OFF
SET NEAR OFF
set confirm on
CLEAR
XOBS = SPACE (3)
STORE CTOD('00/00/0000') TO XDATE
XSTUDYAREA = SPACE (4)
XCOLOR = SPACE(3)
@ 08,10 SAY "THIS PROGRAM IS USED TO ENTER NEST DATA,"
@ 09,10 SAY "AND EGG MEASUREMENTS"
@ 10,10 SAY "ENTER ALL DATA IN CAPITOL LETTERS"
@ 11,10 SAY "ENTER 'BAND' FOR NEST # FOR BIRDS NOT ASSOC WITH NESTS"
@ 12,10 SAY "ENTER  QUIT  FOR NEST NUMBER TO TERMINATE PROGRAM"
@ 13,10 SAY "ENTER OBSERVER CODE "
@ 13,31 GET XObs PICTURE "@A! XXX" 
@ 14,10 SAY "ENTER DATE OF NEST VISIT"
@ 14,37 GET XDate ;
   RANGE CTOD('04/01/2001'),CTOD('09/01/2001') 
@ 15,10 SAY "ENTER STUDY AREA"
@ 15,28 GET XSTUDYAREA PICTURE "@A!M HOCK,KIGI,IRD ,TUTA,OLDC,ESPN,NONE"
READ
IF XSTUDYAREA = "NONE"
XSTUDYAREA = "    "
@ 15,28 GET XSTUDYAREA PICTURE "@A!M"
READ
ENDIF
CLEAR
* START OF MAIN LOOP
QQQ=1
DO WHILE QQQ<100
* DECLARIATION OF SPACE VARIABLES
ANSWER = SPACE (1)
XNEST = SPACE (6)
XSPECIES = SPACE(4)
XTIME = 0
XPHOTO = 000
XNO_EGGS = SPACE(2)
XEGGS_NEW = SPACE(2)
XEGGS_MISS = SPACE(2)
XWARM= SPACE(1)
XDRAKE= SPACE(1)
XDOWN= SPACE (1)
XHEN_STAT = SPACE (1)
XFLOAT1 = SPACE (2)
XFLOAT2 = SPACE (2)
XCANDLE1 = SPACE (3)
XCANDLE2 = SPACE (3)
XSTATUS = SPACE (10)
STORE CTOD('00/00/0000') TO XNEXT
XCOMMENTS = SPACE (60)
XEASTING = 0
XNORTHING = 0
XGPS=SPACE(1)
XHABTYPE = SPACE (6)
XVEGTYPE = SPACE (6)
XSITE = SPACE (6)
XVEG_HT = SPACE (3)
XVEG_DENS1 = SPACE(3)
XVEG_DENS2 = SPACE (3)
XH20_DIST = SPACE (4)
XDOM_SPEC1 = SPACE (6)
XDOM_SPEC2 = SPACE (6)
XDOM_SPEC3 = SPACE (6)
XDOM_SPEC4 = SPACE (6)
XSPEC_COV1 = SPACE (3)
XSPEC_COV2 = SPACE (3)
XSPEC_COV3 = SPACE (3)
XSPEC_COV4 = SPACE (3)
XNMARK = .T.
STORE .T. TO xxray,xdna,xwaes,xlead
@ 6,10 SAY "ENTER 'QUIT' TO EXIT PROGRAM"
@ 8,10 SAY "ENTER 'BAND' FOR EIDER SIGHTINGS"
@ 10,10 SAY "ENTER NEST NUMBER:"
@ 10,31 GET XNesT PICTURE "@! XXXXXX" 
READ
IF XNEST = "      "
LOOP
ENDIF
CLEAR
    IF XNEST = "QUIT"
	EXIT
    ENDIF
IF XNEST="BAND  "
DO RESIGHT
LOOP
ENDIF
USE VISIT ORDER NEST
* CHECKING FOR PREVIOUS NEST RECORDS
FIND &XNEST
IF EOF() 
@ 08,10 SAY "NEST NUMBER ENTERED : "
@ 08,35 SAY XNEST
@ 10,10 SAY "NEW NEST (N) OR INCORRECT ENTRY (I)?"
@ 10,60 GET ANSWER PICTURE "@A!M N,I"
READ
IF ANSWER = "I"
CLEAR
LOOP 
ELSE
CLEAR
ENDIF
ELSE 
CLEAR
ENDIF
* DISPLAYING PREVIOUS RECORDS

GO TOP
@ 0,0 SAY "NESTNO" 
@ 0,7 SAY "SPEC" 
@ 0,12 SAY "PHO" 
@ 0,16 SAY "DATE" 
@ 0,25 SAY "TIME" 
@ 0,30 SAY "OBS" 
@ 0,34 SAY "NE" 
@ 0,37 SAY "NN" 
@ 0,40 SAY "NM" 
@ 0,43 SAY "W" 
@ 0,45 SAY "D" 
@ 0,47 SAY "H" 
@ 0,49 SAY "D" 
@ 0,51 SAY "F1" 
@ 0,54 SAY "F2" 
@ 0,57 SAY "C1" 
@ 0,61 SAY "C2" 
@ 0,65 SAY "STATUS" 
SEEK xnest
STORE 1 TO line
DO WHILE xnest = nest_no
@ line,0 SAY Nest_no PICTURE "XXXXXX" 
@ line,7 SAY Species PICTURE "XXXX"
@ line,12 SAY Photo PICTURE "999" 
@ line,16 SAY Date
@ line,25 SAY Time PICTURE "9999" 
@ line,30 SAY Obs PICTURE "XXX" 
@ line,34 SAY No_eggs PICTURE "99" 
@ line,37 SAY Eggs_new PICTURE "99" 
@ line,40 SAY Eggs_miss PICTURE "99" 
@ line,43 SAY Warm PICTURE "Y" 
@ line,45 SAY Down PICTURE "X" 
@ line,47 SAY Hen_stat PICTURE "X" 
@ line,49 SAY Drake PICTURE "Y" 
@ line,51 SAY Float1 PICTURE "XX" 
@ line,54 SAY Float2 PICTURE "XX" 
@ line,57 SAY Candle1 PICTURE "99" 
@ line,61 SAY Candle2 PICTURE "99" 
@ line,65 SAY Status PICTURE "XXXXXXXXXX"
@ line+1,5 SAY "NEXT VISIT" 
@ line+1,25 SAY Comments PICTURE "XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX" 
@ line+1,16 SAY NexTVISIT
SKIP
line = line+2
IF LINE > 17
WAIT
CLEAR
LINE = 1
SKIP -1
ENDIF
ENDDO
	SKIP -1
	XPHOTO=photo
	XSPECIES=SPECIES
	XSTATUS=STATUS
	XEASTING=EASTING
	XNORTHING=NORTHING
	XGPS=GPS
	XLINT = LINT

* ENTERING NEW NEST DATA
*-- @ SAY GETS Processing. -----------------------------------------------------
?
?
IF answer <> 'N'
STORE ' ' TO rt
@ 18,0 SAY 'I say again, "Is dis de right nest?"'
@ 18,38 GET rt PICTURE '@A!M Y,N'
READ
IF LEFT(UPPER(rt),1) <> 'Y'
	LOOP
ELSE
	SEEK xnest
	REPL check WITH .T. WHILE nest_no=xnest
ENDIF
@ 18,0 CLEAR TO 18,79
ENDIF
*--  Format Page: 1
@ 17,0 TO 17,79 DOUBLE
@ 17,0 SAY "NESTNO" 
@ 17,7 SAY "SPEC" 
@ 17,12 SAY "PHO" 
@ 17,16 SAY "DATE" 
@ 17,25 SAY "TIME" 
@ 17,30 SAY "OBS" 
@ 17,34 SAY "NE" 
@ 17,37 SAY "NN" 
@ 17,40 SAY "NM" 
@ 17,43 SAY "W" 
@ 17,45 SAY "D" 
@ 17,47 SAY "H" 
@ 17,49 SAY "M" 
@ 17,51 SAY "F1" 
@ 17,54 SAY "F2" 
@ 17,57 SAY "C1" 
@ 17,61 SAY "C2" 
@ 17,65 SAY "STATUS"
@ 18,0 SAY XNest PICTURE "XXXXXX" 
STORE "N" TO CHANCE
DO WHILE CHANCE="N"
@ 18,7 GET XSpecies PICTURE "@A!M NOPI,GRSC,SPEI,OLDS,NOSH,AGWT,COEI,MALL,REDH,RBME,STEI,NONE" DEFAULT XSPECIES
@ 18,12 GET XPhoto PICTURE "999" 
@ 18,16 SAY XDate
@ 18,25 GET XTime PICTURE "9999";
   RANGE 0000, 2400
@ 18,30 SAY XObs PICTURE "XXX" 
@ 18,34 GET XNo_eggs PICTURE "99" 
@ 18,37 GET XEggs_new PICTURE "99"  
@ 18,40 GET XEggs_miss PICTURE "99" 
@ 18,43 GET XWarm PICTURE "@A!M Y,N,"
@ 18,45 GET XDown PICTURE "@A!M N,S,A," 
@ 18,47 GET XHen_stat PICTURE "@A!M F,P,A," 
@ 18,49 GET XDrake PICTURE "@A!M Y,N,"
@ 18,51 GET XFloat1 PICTURE "@A!M ,SF,SA,SO,SP,FN,FB,FO,FA,PS,PP," 
@ 18,54 GET XFloat2 PICTURE "@A!M ,SF,SA,SO,SP,FN,FB,FO,FA,PS,PP," 
@ 18,57 GET XCandle1 PICTURE "99" 
@ 18,61 GET XCandle2 PICTURE "99" 
@ 18,65 GET XStatus PICTURE "@A!M LAYING,INCUBATING,TRAPPED,DUCKLINGS,ABANDONED,FLOODED,PREDATED,HATCHED,OTHER,BROOD" 
@ 19,5 get xcomments
@ 20,50 SAY "NORTHING"
@ 20,28 SAY "EASTING"
@ 20,70 SAY 'GOOD'
@ 20,37 get xeasting picture "999999" default xeasting
@ 20,60 GET XNORTHING PICTURE "9999999" DEFAULT XNORTHING
@ 20,75 GET XGPS PICTURE "@A!M Y,N,"
@ 20,5 SAY "NEXT VISIT" 
READ

DO CASE
*	CASE XSPECIES = 'NOPI' 
*		fage = 24-max(val(xcandle1),val(xcandle2)) && hatch = 24
	CASE XSPECIES = 'SPEI'
		fage = 23-max(val(xcandle1),val(xcandle2)) && hatch = 24
*	CASE XSPECIES = 'NOSH' .OR. XSPECIES = 'AGWT'
*		fage = 24-max(val(xcandle1),val(xcandle2)) && hatch = 23
*	CASE XSPECIES = 'REDH'
*		fage = 26-max(val(xcandle1),val(xcandle2)) && hatch = 26
	CASE XSPECIES = 'OLDS' 
		fage = 22-max(val(xcandle1),val(xcandle2)) && hatch = 24
*	CASE XSPECIES = 'BLSC'
*		fage = 28-max(val(xcandle1),val(xcandle2)) && hatch = 28
	CASE XSPECIES = 'COEI'
		fage = 23-max(val(xcandle1),val(xcandle2)) && hatch = 26
*	CASE XSPECIES = 'UNEI'
*		fage = 26-max(val(xcandle1),val(xcandle2)) && hatch = 26
	CASE XSPECIES = 'GRSC'
		fage = 24-max(val(xcandle1),val(xcandle2)) && hatch = 24
	OTHERWISE
		fage = 100
ENDCASE
* SETTING VISITATION INTERVAL
IF fage < 7
	XNEXT = XDATE+(FAGE-1)
ELSE
	DO CASE
		CASE XSPECIES = 'SPEI' .or. xspecies='GRSC' .OR. XSPECIES='COEI' .OR. XSPECIES='OLDS' .OR. XSPECIES='UNEI'
			xnext = xdate+7
                CASE XHEN_STAT<>'F' .AND. XDOWN='N'
                        xnext = XDATE+7
		OTHERWISE
			xnext = CTOD('01/01/2001')
	ENDCASE
ENDIF
DO CASE
     CASE XSTATUS = "TRAPPED"
	XNEXT= XDATE+1
     CASE XSTATUS = "DUCKLINGS"
	XNEXT=XDATE+1
     CASE xstatus = "ABANDONED"  .or. xstatus="PREDATED" .or. xstatus="HATCHED"
	xnext = Ctod('01/01/2001')
     CASE xstatus = 'BROOD'
	xnext = xdate+7
	xphoto = 999
	DO BROOD
ENDCASE
@ 20,16 GET XNext ;
   RANGE CTOD('00/00/2001'),CTOD('09/01/2001') 

@ 21,10 SAY 'IS EVERYTHING KOSHER??'
@ 21,35 GET CHANCE PICTURE "@A!M Y,N" 
READ
ENDDO
APPEND BLANK
REPLACE NEST_NO WITH XNEST, SPECIES WITH XSPECIES, STUDYAREA WITH XSTUDYAREA
REPL PHOTO WITH XPHOTO, DATE WITH XDATE, TIME WITH XTIME, OBS WITH XOBS
REPL NO_EGGS WITH VAL(XNO_EGGS), EGGS_NEW WITH VAL(XEGGS_NEW), EGGS_MISS WITH VAL(XEGGS_MISS)
REPL WARM WITH XWARM, DRAKE WITH XDRAKE, DOWN WITH XDOWN, HEN_STAT WITH XHEN_STAT
REPLACE FLOAT1 WITH XFLOAT1,FLOAT2 WITH XFLOAT2,CANDLE1 WITH XCANDLE1,CANDLE2 WITH XCANDLE2,;
	STATUS WITH XSTATUS, COMMENTS WITH XCOMMENTS, NEXTVISIT WITH XNEXT
REPLACE EASTING WITH XEASTING, NORTHING WITH XNORTHING, LINT WITH xlint, GPS WITH XGPS
CLEAR

* ENTERING HABITAT DATA FOR FIRST NEST VISITS
IF ANSWER = "N"
CLEAR
STORE "N" TO CHANCE
DO WHILE CHANCE="N"
@ 00,10 SAY "NO PREVIOUS RECORDS, ENTER NEST CHARACTERISTICS"
@ 02,01 SAY "SPECIES  PHOTO  HABTYPE  VEGTYPE  SITE  VEG_HT"
@ 03,01 SAY xspecies
@ 03,10 SAY xphoto
@ 03,17 GET XHABTYPE PICTURE "@A!M GRASSFLT,INTERMED,UPLAND,OTHER"
READ
IF XHABTYPE = "OTHER"
XHABTYPE = "      "
@03,17 GET XHABTYPE PICTURE "@A!M XXXXXXXX"
READ
ENDIF
@ 03,26 GET XVEGTYPE PICTURE "@A!M MEADOW,SHRUB,EMERGENTS,MOSS,FORBES,BARE,OTHER"
READ
IF XVEGTYPE = "OTHER"
XVEGTYPE = "      "
@03,26 GET XVEGTYPE PICTURE "@A!M XXXXXXXXX"
READ
ENDIF
@ 03,35 GET XSITE PICTURE "@A!M SLBNK,SLBNKI,SLBNKT,SLBNKO,POLSHR,LAKSHR,PENINS,ISLAND,DISPIS,PINGO,PINGOSD,DISTUR,GFLAT,OTHER"
READ
IF XSITE = "OTHER"
XSITE = "      "
@ 03,35 GET XSITE PICTURE "@A!M XXXXXX"
READ
ENDIF
@ 03,42 GET XVEG_HT
*@ 04,01 SAY "                                PAINTED"
@ 05,01 SAY "                      H20_DIST"
* 06,01 GET XVEG_DENS1
* 06,12 GET XVEG_DENS2
@ 06,24 GET XH20_DIST
* 06,35 GET XNMARK
@ 08,10 SAY "DOM SPEC    % COVER"
@ 09,01 SAY "SPEC1"
@ 10,01 SAY "SPEC2"
@ 11,01 SAY "SPEC3"
@ 12,01 SAY "SPEC4"
@ 09,12 GET XDOM_SPEC1 PICTURE "@A!M ,ELYMUS,C.RAM,CALAM,POTENT,PUCCEN,LIGUST,BETULA,C.UNK,POA,SALIX,VACCIN,BARE,EMPETR,C.RARE,LITTER,OTHER"
READ
IF XDOM_SPEC1 = "OTHER "
XDOM_SPEC1 = "      "
@ 09,12 GET XDOM_SPEC1 PICTURE "@A! XXXXXX"
ENDIF
@ 09,25 GET XSPEC_COV1
@ 10,12 GET XDOM_SPEC2 PICTURE "@A!M ,ELYMUS,C.RAM,CALAM,POTENT,PUCCEN,LIGUST,BETULA,C.UNK,POA,SALIX,VACCIN,BARE,EMPETR,C.RARE,LITTER,OTHER"
READ
IF XDOM_SPEC2 = "OTHER "
XDOM_SPEC2 = "      "
@ 10,12 GET XDOM_SPEC2 PICTURE "@A! XXXXXX"
ENDIF
@ 10,25 GET XSPEC_COV2
@ 11,12 GET XDOM_SPEC3 PICTURE "@A!M ,ELYMUS,C.RAM,CALAM,POTENT,PUCCEN,LIGUST,BETULA,C.UNK,POA,SALIX,VACCIN,BARE,EMPETR,C.RARE,LITTER,OTHER"
READ
IF XDOM_SPEC3 = "OTHER "
XDOM_SPEC3 = "      "
@ 11,12 GET XDOM_SPEC3 PICTURE "@A! XXXXXX"
ENDIF
@ 11,25 GET XSPEC_COV3
@ 12,12 GET XDOM_SPEC4 PICTURE "@A!M ,ELYMUS,C.RAM,CALAM,POTENT,PUCCEN,LIGUST,BETULA,C.UNK,POA,SALIX,VACCIN,BARE,EMPETR,C.RARE,LITTER,OTHER"
READ
IF XDOM_SPEC4 = "OTHER "
XDOM_SPEC4 = "      "
@ 12,12 GET XDOM_SPEC4 PICTURE "@A! XXXXXX"
ENDIF
@ 12,25 GET XSPEC_COV4
READ
@ 14,10 SAY "ARE YOU PERFECT??"
@ 14,30 GET CHANCE PICTURE "@A!M Y,N"
READ
ENDDO
USE HEADER
APPEND BLANK
REPLACE NEST_NO WITH XNEST, SPECIES WITH XSPECIES,STUDYAREA WITH XSTUDYAREA,;
 PHOTO WITH XPHOTO, easting with xeasting, northing with xnorthing, HABTYPE WITH XHABTYPE
REPLACE VEGTYPE WITH XVEGTYPE, SITE WITH XSITE, VEG_HT WITH VAL(XVEG_HT),;
  VEG_DENS1 WITH VAL(XVEG_DENS1), VEG_DENS2 WITH VAL(XVEG_DENS2), H20_DIST WITH VAL(XH20_DIST),NMARK WITH xnmark
REPLACE DOM_SPEC1 WITH XDOM_SPEC1
REPLACE SPEC_COV1 WITH VAL(XSPEC_COV1)
REPLACE DOM_SPEC2 WITH XDOM_SPEC2
REPLACE SPEC_COV2 WITH VAL(XSPEC_COV2)
REPLACE DOM_SPEC3 WITH XDOM_SPEC3
REPLACE SPEC_COV3 WITH VAL(XSPEC_COV3)
REPLACE DOM_SPEC4 WITH XDOM_SPEC4
REPLACE SPEC_COV4 WITH VAL(XSPEC_COV4)
CLEAR
ELSE
CLEAR
ENDIF
* ENTERING DATA FOR NEST TRAPPED FEMALES
IF XSTATUS = 'TRAPPED'
	DO MARK

LOOP
ENDIF
* ENTERING EGG MEASUREMENT DATA
IF VAL(XEGGS_NEW) > 0
first = .Y.
@ 10,10 SAY "DO YOU HAVE EGG MEASUREMENTS FOR THIS NEST"
@ 10,58 GET first picture "@A!M Y,N" default .Y.
READ
IF FIRST
CLEAR
USE EGG ORDER NEST
COUNTER=0
NUMBER=VAL(XEGGS_NEW) 
DO WHILE number > 16 .OR. first
	@ 10,10 SAY "HOW MANY NEW EGGS WERE MEASURED"
	@ 11,10 SAY XNEST
	@ 11,20 GET NUMBER PICTURE "99" DEFAULT number
	READ
	first = .N.
ENDDO
CLEAR
IF NUMBER=00
LOOP
ENDIF
DECLARE EGG[NUMBER,3]
X=1
DO WHILE X<(NUMBER+1)
	EGG[X,1] = 00
	EGG[X,2] = 00.0
	EGG[X,3] = 00.0
	X=X+1
ENDDO
SEEK XNEST
STORE 3 TO LINE
TALLY=0
IF EOF()
@ 01,14 SAY "NO PREVIOUS RECORDS"
ELSE
DO WHILE xnest = nest_no
@ 02,00 SAY "NEST    SPEC DATE     OBS  EGG LENGTH WIDTH "
@ line,0 SAY Nest_no PICTURE "XXXXXX" 
@ line,8 SAY Species PICTURE "XXXX"
@ line,13 SAY Date
@ line,22 SAY Obs PICTURE "XXX" 
@ line,27 say eggno picture "999"
@ line,32 say length picture "99.9"
@ line,38 say width picture "99.9"
SKIP
line = line+1
TALLY=TALLY+1
ENDDO
endif
X=1
do while counter < number
TALLY=TALLY+1
@ 02,00 SAY "NEST    SPEC DATE     OBS  EGG LENGTH WIDTH "
@ line,0 say XNEST picture "XXXXXX"
@ LINE,8 SAY XSPECIES PICTURE "XXXX"
@ LINE,13 SAY XDATE
@ LINE,22 SAY XOBS PICTURE "XXX"
@ LINE,27 SAY TALLY PICTURE "99"
@ line,27 get EGG[X,1] picture "999"
@ LINE,32 GET EGG[X,2] PICTURE "99.9"
@ LINE,38 GET EGG[X,3] PICTURE "99.9"
LINE = LINE +1
COUNTER = COUNTER +1
X=X+1
ENDDO
READ
X=1
DO WHILE X<(NUMBER+1)
APPEND BLANK
REPLACE NEST_NO WITH XNEST
REPLACE SPECIES WITH XSPECIES
REPLACE DATE WITH XDATE
REPLACE OBS WITH XOBS
REPLACE EGGNO WITH EGG[X,1] 
REPLACE LENGTH WITH EGG[X,2]
REPLACE WIDTH WITH EGG[X,3]
X=X+1
ENDDO
ENDIF
ENDIF
CLEAR
* ENTERING WEBTAG DATA
IF XSTATUS = "DUCKLINGS"
STORE 3 TO LINE
TALLY=0
USE EGG ORDER nest
seek xnest
do while xnest=nest_no
tally=tally+1
skip
enddo
go top
DECLARE TAG[TALLY,4]
X=1
DO WHILE X<(TALLY+1)
	TAG[X,1] = " "
	TAG[X,2] = 0000
	TAG[X,3] = 00.0
	TAG[X,4] = 0000
	X=X+1
ENDDO
Y=1
SEEK XNEST
DO WHILE XNEST=NEST_NO
@ 2,0 SAY "NEST    SPEC DATE     OBS  EGG LENGTH WIDTH LINK TAG  WGT RADIO"
@ line,0 SAY Nest_no PICTURE "XXXXXX" 
@ line,8 SAY Species PICTURE "XXXX"
@ line,13 SAY Date
@ line,22 SAY Obs PICTURE "XXX" 
@ line,27 say eggno picture "999"
@ line,32 say length picture "99.9"
@ line,38 say width picture "99.9"
@ line,45 get tag[Y,1] PICTURE "@A!M Y,N"
IF WEBTAG <> 0
@ LINE,48 SAY WEBTAG
ELSE
@ LINE,48 GET TAG[Y,2] PICTURE "9999"
ENDIF
IF WEIGHT <> 0.0
@ LINE,53 SAY WEIGHT
ELSE
@ LINE,53 GET TAG[Y,3] PICTURE "99.9"
ENDIF
IF RADIO <> 0
@ LINE,58 SAY RADIO
ELSE
@ LINE,58 GET TAG[Y,4] PICTURE "9999"
ENDIF
SKIP
Y=Y+1
line = line+1
ENDDO
READ
GO TOP
SEEK XNEST
X=1
DO WHILE XNEST=NEST_NO
IF LINK = " "
REPLACE LINK WITH TAG[X,1] 
ENDIF
IF WEBTAG = 0
REPLACE WEBTAG WITH TAG[X,2] 
ENDIF
IF WEIGHT=0
REPLACE WEIGHT WITH TAG[X,3] 
ENDIF
IF RADIO=0
REPLACE RADIO WITH TAG[X,4] 
replace tagdate with xdate
ENDIF
X=X+1
SKIP
enddo
ENDIF
CLEAR
IF XSPECIES='SPEI' .and. xhen_stat="F" .OR. XSPECIES='SPEI' .AND. XHEN_STAT='P'
DO RESIGHT
ENDIF
ENDDO
CLEAR ALL
CLOSE ALL
RUN c:\progra~1\winzip\winzip32.exe  -F QUACKBAK
CLEAR
?
? 'INSERT BACKUP DISK IN DRIVE A:'
?
WAIT
RUN COPY QUACKBAK.ZIP A:
RETURN
PROCEDURE BROOD
	CLEAR
	SET TALK OFF
	SELE C
	USE C:MARKDATA ORDER FREQUENCY
	SET FILTER TO VAL(FREQUENCY)>2000
	COUNT TO nfreq
	GOTO TOP
	x=1
	DECLARE zfreq[nfreq,3]
	DO WHILE .NOT. EOF()
	   zfreq[x,1] = frequency
	   zfreq[x,2] = speciescod
	   zfreq[x,3] = nest_no
	   x=x+1
	   SKIP
	ENDDO
	USE
	x = 1
	DO WHILE x < nfreq+1
	   IF zfreq[x,3] = xnest
		xfreq = zfreq[x,1]
	   ENDIF
	   x=x+1
	ENDDO
	? xfreq
	USE BROODS
	mnest2 = xnest
	obs = xobs
	*-- @ SAY GETS Processing. -----------------------------------------------------
	APPEND BLANK
	species = xspecies
	date = xdate 
	time = xtime
	*--  Format Page: 1
	@ 1,14 SAY "FREQ" 
	@ 1,25 SAY xFreq PICTURE "XXXX" 
	@ 1,32 SAY "SPECIES" 
	@ 1,43 SAY XSpecies PICTURE "XXXX" 
	@ 3,14 SAY "DATE" 
	@ 3,25 SAY XDate 
	@ 3,35 SAY "TIME" 
	@ 3,46 SAY XTime PICTURE "9999" 
	@ 5,26 SAY "OBS" 
	@ 5,37 SAY XObs PICTURE "XXX" 
	@ 7,16 SAY "STATUS" 
	@ 7,27 GET Status PICTURE "@M BROODY,COUNT,PARTIAL,FLUSHED" 
	@ 9,16 SAY "NUMBER" 
	@ 9,27 GET Number PICTURE "99" 
	@ 9,45 SAY 'Days since last visit:'
	@ 9,65 SAY xdate-visit->date
	@ 11,16 SAY "SALINITY" 
	@ 11,27 GET Salinity PICTURE "99.99" RANGE 0,35
	@ 13,16 SAY "COMMENTS" 
	@ 13,27 GET Comments PICTURE "XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX" 
	@ 15,16 SAY "NEXTVISIT" 
	@ 15,27 GET xnext RANGE CTOD('1/1/2001'),CTOD('8/30/2001')
	READ
	REPLACE freq with xfreq,obs WITH xobs,nest_no with xnest, species with xspecies,date with xdate,time with xtime,obs with xobs,nextvisit with xnext
	xcomments = freq+' '+comments
	USE
	SELE A
	
	*-- Format file exit code -----------------------------------------------------
RETURN
PROCEDURE RESIGHT
CLEAR screen
SET TALK OFF
SELE C  && OPEN FILE IN NEW WORK AREA
xSpecies = 'SPEI'
USE resight
more = .Y.
DO WHILE more
	more = .N.
	ok = .F.
	rcap = .N.
	rmark= SPACE(4)
	rsex = 'F' 
	rnest = xnest
	rassn= SPACE(4)
	RDate = xdate
	rTime= xtime
	RComm = space(40) 
	DO WHILE .NOT. ok
		rtars = SPACE(3)
		rnasl = SPACE(3)
		*--  @SAY's
		@ 0,7 TO 20,73 DOUBLE 
		@ 1,24 SAY "SPECTACLED EIDER RESIGHTING DATA" 
		@ 3,29 SAY "IS THIS A CAPTURE" 
		@ 5,18 SAY "MARKERS:" 
		@ 5,28 SAY "FIRST MARKER SEEN" 
		@ 6,34 SAY "TARSUS BAND" 
		@ 7,35 SAY "NASAL DISK" 
		@ 9,18 SAY "SEX" 
		@ 9,40 SAY "DATE" 
		@ 10,18 SAY "NEST_NO" 
		@ 10,40 SAY "TIME" 
		@ 11,18 SAY "ASSOCIATION" 
		@ 11,40 SAY "OBS" 
		@ 13,18 SAY "LOCATION:" 
		@ 13,29 SAY "EASTING" 
		@ 14,29 SAY "NORTHING" 
		@ 16,13 SAY "COMMENTS" 
		@ 18,13 SAY "Everything Otay?"
		*--  @GET's
		@ 3,49 GET rcap PICTURE "L" DEFAULT .N.
		@ 5,47 GET rmark PICTURE "@!M TARS,NASA,META,NONE"
		@ 6,48 GET rtars PICTURE "@!M OTH,RED,YEL,NON,PRE,UNK"  
		READ
		IF rtars = 'OTH'
			rtars = '   '
			@ 6,48 GET rtars PICTURE "@!XXX"  
			READ
			IF rtars = '   '
				LOOP
			ENDIF
		ENDIF 
		@ 7,48 GET rnasl PICTURE "@!M OTH,NON,PRE,UNK,OLD"
		READ
		IF rnasl = 'OTH'
			rnasl = '   '
			@ 7,48 GET rnasl PICTURE "@!XXX"  
			READ
			IF rnasl = '   '
				LOOP
			ENDIF
		ENDIF 
		@ 9,30 GET rsex PICTURE "@!M M,F,U" DEFAULT 'F' 
		@ 10,30 GET rnest PICTURE "XXXXXX"  DEFAULT xnest
		@ 11,30 GET rassn PICTURE "@A!M NEST,BROO,PAIR,FLOC,ALON,DEAD,OTHE" 
		@ 9,52 GET   RDate RANGE CTOD('4/1/2001'),CTOD('9/1/2001') DEFAULT xdate
		@ 10,52 GET rTime PICTURE "@L 9999" RANGE 01,2400 default xtime
		@ 11,52 SAY XObs PICTURE "@A! XXX" 
		@ 13,41 GET XEastING PICTURE "99999999"
		@ 14,41 GET XNorthING PICTURE "999999999" 
		@ 16,25 GET RComm PICTURE "XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX" 
		*-- Format file exit code -----------------------------------------------------
		READ
		@ 18,35 GET ok
		READ
		IF ok .AND. rcap
			DO mark
			USE resight
			clear screen
		ENDIF
	ENDDO
	@ 19,13 SAY "Enter more resightings?"
	@ 19,40 GET more
	READ
append blank
REPL capture WITH rcap, first_mark WITH rmark, tarsal WITH rtars, ;
	nasal WITH rnasl, sex WITH rsex, nest_no WITH rnest, assoc WITH rassn,;
	date WITH rdate, time WITH rtime, obs WITH xobs, easting WITH XeastING, ;
	northing WITH XnorthING, comments WITH rcomm
enddo
USE   && CLOSE resight.dbf
SELE A  && SELECT PRIMARY WORK AREA
CLEAR 
RETURN
PROCEDURE MARK
CLEAR 
xprefixnumb = space (4)
xbandnumber = space(6)
xrcap = .N.
xfrequency = space (4)
xage = space(3)
xsex = space(1)
xwt = 0
xculmen = 0
xtarsus = 0
xwing = 0
XTARSAL = SPACE(3)
XNASAL = SPACE(3)
bcomments = SPACE(40)
	USE MARKDATA
	*-- @ SAY GETS Processing. -----------------------------------------------------
	
	*--  Format Page: 1
	@ 0,22 TO 20,49 DOUBLE 
	@ 1,24 SAY "DATE" 
	@ 1,36 SAY XDate 
	@ 2,24 SAY "NEST_NO" 
	@ 2,36 GET XNEST PICTURE 'XXX999'
	@ 3,23 SAY "컴컴컴컴컴컴컴컴컴컴컴컴컴" 
	@ 4,24 SAY "RECAPTURE"
	@ 4,36 GET XRCAP PICTURE "Y" DEFAULT .N.
	@ 5,24 SAY "BANDNUMBER" 
	@ 5,36 GET XPrefixnumb PICTURE "9999" 
	@ 5,40 SAY "-" 
	@ 5,41 GET XBandnumber PICTURE "99999" 
	@ 6,24 SAY "FREQUENCY" 
	@ 6,36 GET XFrequency PICTURE "9999" 
	@ 7,24 SAY 'NASAL MARK'
	@ 7,36 GET xnasal PICTURE 'XXX'
	@ 8,24 say 'TARSAL MARK'
	@ 8,36 GET XTARSAL PICTURE 'XXX'
	@ 9,23 SAY "컴컴컴컴컴컴컴컴컴컴컴컴컴" 
	@ 10,24 SAY "SPECIES" 
	@ 10,36 SAY XSpecies 
	@ 11,24 SAY "AGE" 
	@ 11,36 GET XAge PICTURE "@A!M AHY,ASY,SY,LOC,UNK" 
	@ 12,24 SAY "SEX" 
	@ 12,36 GET XSex PICTURE "@A!M F,M,U" 
	@ 13,23 SAY "컴컴컴컴컴컴컴컴컴컴컴컴컴" 
	@ 14,24 SAY "WT" 
	@ 14,36 GET XWt PICTURE "9999" 
	@ 15,24 SAY "CULMEN" 
	@ 15,36 GET XCulmen PICTURE "999" 
	@ 16,24 SAY "TARSUS" 
	@ 16,36 GET XTarsus PICTURE "999" 
	@ 17,24 SAY "WING" 
	@ 17,36 GET XWing PICTURE "999" 
	@ 18,23 SAY "컴컴컴컴컴컴컴컴컴컴컴컴컴" 
	@ 18,24 SAY "COMMENTS" 
	@ 19,36 GET bcomments PICTURE "@S10 XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX" 
	@ 05,55 SAY 'X-RAY'
	@ 07,55 SAY 'BLOOD SAMPLES'
	@ 09,55 SAY 'LEAD'
	@ 11,55 SAY 'DNA'
	@ 13,55 SAY 'WAES BLOOD'
	@ 05,70 GET xxray
	@ 09,70 GET xlead
	@ 11,70 GET xdna
	@ 13,70 GET xwaes
	@ 15,55 SAY 'EASTING:'
	@ 16,55 SAY 'NORTHING:'
	@ 15,70 GET Xeasting PICTURE '999999'
	@ 16,70 GET xnorthing PICTURE '99999999'
	
	READ
	 APPEND BLANK
	 REPLACE speciescod with xspecies, DATE with Xdate, PREFIXNUMB with XPREFIXNUMB,;
	 NASAL with xNASAL, TARSAL WITH XTARSAL, BANDNUMBER with XBANDNUMBER,;
	 FREQUENCY with XFREQUENCY, SPECIESCOD with XSPECIES, SEX with XSEX,nest_no WITH xnest,;
	 AGE with XAGE, WT WITH XWT, WING with XWING, CULMEN with XCULMEN,;
	 TARSUS with XTARSUS, COMMENTS with BCOMMENTS,RECAP with xrcap,;
	 easting with xeasting, northing with xnorthing
	REPL dna WITH xdna,waes WITH waes,lead WITH xlead,xray WITH xxray

USE
CLEAR
return
